За <script type="math/tex">O(n^2)</script> находим максимум <script type="math/tex">a</script> и второй максимум <script type="math/tex">b</script> в матрице. Если полученные элементы не лежат в одной строке или столбце, то задача решена. Если же лежат &#8212; находим максимальный элемент <script type="math/tex">c</script> из тех элементов, которые не лежат в той строке/столбце, которая общая для <script type="math/tex">a</script> и <script type="math/tex">b</script>. Тогда если <script type="math/tex">c</script> не лежит в строке/столбце с <script type="math/tex">a</script>, то <script type="math/tex">ac</script> будет искомым максимальным произведением. Если лежит &#8212; то находим максимум <script type="math/tex">d</script> среди тех элементов, которые не лежат в той строке/столбце, которая общая для <script type="math/tex">a</script> и <script type="math/tex">b</script> и не лежат в одной строке/столбце с <script type="math/tex">a</script>. Тогда либо <script type="math/tex">bc</script>, либо <script type="math/tex">ad</script> будет искомым максимальным произведением.
