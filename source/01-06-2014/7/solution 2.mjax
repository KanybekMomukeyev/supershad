За <script type="math/tex">O(n^2)</script> операций находим максимумы и вторые максимумы по строкам и столбцам, записываем их вместе с индексами в массив длины <script type="math/tex">O(n)</script>. Для каждого из них выбираем из списка максимальное число, не лежащее с ним ни в одной строке, ни в одном столбце, и перемножаем. Из полученных произведений выбираем максимальное.
